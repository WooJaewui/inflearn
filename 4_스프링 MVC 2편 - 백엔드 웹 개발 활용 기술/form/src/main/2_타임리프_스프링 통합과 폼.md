
# 타임리프_스프링 통합과 폼.

-----------------------------------------------------------------------------------------------------------------------------

> ## 타임리프 스프링 통합.

### 타임리프 메뉴얼.
- 기본 메뉴얼: https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html
- 스프링 통합 메뉴얼: https://www.thymeleaf.org/doc/tutorials/3.0/thymeleafspring.html


### 개요.
- 타임리프는 스프링 없이도 동작하지만, 스프링과 통합을 위한 다양한 기능을 편리하게 제공한다.
- 그리고 이런 부분은 스프링으로 백엔드 개발하는 개발자 입장에서 타임리프를 선택하는 하나의 이유가 된다.


### 스프링 통합으로 추가되는 기능들.
- 스프링의 SpringEL 문법 통합.
- 편리한 폼 관리를 위한 추가 속성.
- 폼 컴포넌트 기능.
- 스프링의 메시지, 국제화 기능의 편리한 통합.
- 스프링의 검증, 오류 처리 통합.
- 스프링의 변환 서비스 통합.


### 설정 방법.
- 타임리프 템플릿 엔진을 스프링 빈에 등록하고, 타임리프용 뷰 리졸버를 스프링 빈으로 등록하는 방법들이 필요하다.
- 스프링 부트는 이런 부분을 모두 자동화 해준다.


### 스프링 부트 설정 방법.
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf
- gradle에 위 설정 하나만 넣어주면 타임리프를 사용할 수 있다.

-----------------------------------------------------------------------------------------------------------------------------

> ## 입력 폼 처리.

### th:object.
- 오브젝트 정보를 model에 넘겨줘야 한다.
- form에서 사용할 객체를 지정한다.


### th:object="${item}"
- form에서 사용할 객체를 지정한다.
- 선택 변수 식 "*{...}"을 적용할 수 있다.
- 선택 변수 식에 객체에 없는 잘못된 이름을 입력하면 오류가 발생한다.


### th:field.
- id, name, value 속성을 모두 자동으로 만들어준다.
- id, name은 field에 지정한 key 값.
- value는 field에 지정한 value 값.


### 정리.
- th:object, th:field 덕분에 폼을 개발할 때 약간의 편리함을 얻었다.
- 이것의 진짜 위력은 뒤에 설명할 검증에서 나타난다.

-----------------------------------------------------------------------------------------------------------------------------

> ## 체크 박스 - 단일1.

### 체크 박스 HTML Form.
- input checkbox에서 체크를 하면"open=on"으로 데이터를 넘겨준다.
- input checkbox에서 체크를 하지 않으면 open 필드 값이 아에 넘어가지 않는다. (open=null)


### HTTP 요청 메시지 로깅.
    logging.level.org.apache.coyote.http11=debug
- application.properties에 작성한다.


### HTML 체크박스 문제.
- checkbox는 선택이 안되면 클라이언트에서 서버로 값 자체를 보내지 않는다.
- 서버 구현에 따라서 값이 오지 않ㅇ는 것으로 판단해서 값을 변경하지 않을 수도 있다.
- 이런 문제를 해결하기 위해서 스플이 MVC는 약간의 트릭을 사용한다.


### _open.
- 체크박스를 체크하면 스프링 MVC가 값이 있는 것을 확인하고 사용한다.
- 기존 체크 박스 이름 앞에 언더스코어(_)를 붙여서 전송하면 체크를 해제했다고 인식할 수 있다.
- 체크박스가 체크하지 않으면 스프링 MVC가 "_openn"만 있는 것을 확인하고, "open"의 값이 체크되지 않았다고 인식한다.
- 이 경우 서버에서 boolean 타입을 찍어보면 결과가 null이 아니라 false인 것을 알 수 있다.

-----------------------------------------------------------------------------------------------------------------------------

> ## 체크 박스 - 단일 2.

### 체크 박스 th:field.
- 체크박스의 경우 th:field를 사용하면 input hidden 태그를 만들어준다. 
- 값이 true인 경우 자동으로 checked 속성이 붙는다.
- 값이 false인 경우 checked 속성이 없어진다.

-----------------------------------------------------------------------------------------------------------------------------

> ## 체크 박스 - 멀티.

### @ModelAttribute의 특별한 사용법.
    @ModelAttribute("regions")
    public Map<String, String> regions() {
        Map<String, String> regions = new LinkedHashMap<>();
        regions.put("SEOUL", "서울");
        regions.put("BUSAN", "부산");
        ...
        return regions;
    }
- 클래스 내에 있는 모든 컨트롤러 Model에 regions이 담긴다.


### th:field 반복.
- 반복에서 th:field를 사용하면 자동으로 1,2,3을 붙여준다.


### ids.prev(...), ids.next(...)
- 동적으로 생성되는 id 1,2,3을 선택할 수 있도록 도와준다.

-----------------------------------------------------------------------------------------------------------------------------

> ## 라디오 버튼.

### 개요.
- Enum을 통해 라디오 버튼을 개발해보자.


### 타임리프에서 ENUM 직접 접근.
    <div th:each="type : ${T(패키지이름.ItemType).values()}">
- 스프링 EL 문법으로 Enum을 직접 사용할 수 있다.
- Enum에 values()를 호출하면 해당 Enum의 모든 정보가 배열로 반환된다.
- 그런데, 이렇게 사용하면 Enum 패키지 위치가 변경되거나 할 때 자바 컴파일러가 타임리프까지 컴파일 오류를 잡을 수 없으므로 추천하지 않는다.

































