
# 메시지 국제화.

----------------------------------------------------------------------------------------------------------------------------------

> ## 메시지, 국제화 소개.

### 개요.
- '상품명'이라는 단어를 모두 '상품이름'으로 고쳐달라고 하면 어떻게 해야 할까?
- 고쳐야 되는 개수가 적으면 문제가 없지만, 수십개 이상이라면 수십개의 파일을 모두 고쳐야 한다.
- 왜냐하면 해당 HTML 파일에 메시지가 하드코딩 되어 있기 때문이다.


### 메시지.
- 이런 다양한 메시지를 한 곳에서 관리하도록 하는 기능을 메시지 기능이라고 한다.
- 예를 들어 'messages.properties' 라는 메시지 관리용 파일을 만들어서 원하는 데이터를 key 값으로 불러서 사용하는 것을 말한다.


### 국제화.
- 메시지에서 설명한 메시지 파일을 각 나라별로 별도로 관리하면 서비스를 국제화할 수 있다.
- 예를 들면, message_en.properties, message_ko_properties


### 국제화를 하는 방법.
- accept-language 헤더 값을 사용하거나 사용자가 직접 언어를 선택하도록 하고, 쿠키 등을 사용해서 처리하면 된다.


### 스프링의 메시지, 국제화 기능.
- 스프링은 기본적인 메시지와 국제화 기능을 모두 제공한다.
- 그리고 타임리프도 스프링이 제공하는 메시지와 국제화 기능을 편리하게 통합해서 제공한다.

----------------------------------------------------------------------------------------------------------------------------------

> ## 스프링 메시지 소스 설정.

### 개요.
- 메시지 관리 기능을 사용하려면 스프링이 제공하는 'MessageSource'를 스프링 빈으로 등록하면 된다.
- MessageSource는 인터페이스다.
- 따라서, 구현체인 ResourceBundleMessageSource를 스프링 빈으로 등록하면 된다.


### 등록 방법.
    @Bean
    public MessageSource messageSource() {
        ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource();
        messageSource.setBasenames("messages", "errors");
        messageSource.setDefaultEncoding("utf-8");
        return messageSource;
    }
- basenames.
  - 설정 파일의 이름을 지정한다.
  - 'messages'로 지정하면 'message.properties'파일을 읽어서 사용한다.
  - 추가로 국제화 기능을 적용하려면 파일명 마지막에 언어 정보를 주면된다.
  - 만약, 찾을 수 있는 국제화 파일이 없으면 'message.properties'를 기본으로 사용한다.
  - 파일 위치는 /resources/messages.properties에 두면 된다.
  - 여러 파일을 한번에 지정할 수 있다. 여기서는 'messages', 'errors' 둘을 지정했다.
- defaultEncoding.
  - 인코딩 정보를 지정한다. (utf-8)


### 스프링 부트.
- 스프링 부트를 사용하면 자동으로 'MessageSource'를 빈으로 등록한다.


### 스프링 부트 메시지 소스 설정.
    // 기본값. (따로 설정 하지 않았을 때)
    spring.messages.basenames=messages

    // 여러 파일 설정.
    spring.messages.basenames=messages,config.i18n.messages
- 스프링 부트를 사용하면 다음과 같이 메시지 소스를 설정할 수 있따.

----------------------------------------------------------------------------------------------------------------------------------

> ## 스프링 메시지 소스 사용.

### MessageSource 인터페이스.
- getMessage(String code, @Nullable Object[] args, @Nullable String defaultMessage, Locale locale);
- getMessage(String code, @Nullable Object[] args, Locale locale) throws NoSuchMessageException;

----------------------------------------------------------------------------------------------------------------------------------

> ## 웹 어플리케이션에 국제화 적용하기.

### 국제화.
- Accept-Language에 q의 크기에 따라 언어의 우선순위가 결정된다.
- q가 없는 게 가장 우선순위가 높은 언어이다.
- 웹 브라우저 언어 설정에서 변경할 수 있다.


### 스프링의 국제화 메시지 선택.
- 국제화를 사용하려면 스프링도 Locale 정보를 알아야 하는데, Accept-Language 헤더의 값을 사용한다.


### LocaleResolver.
- 스프링은 Locale 선택 방식을 변경할 수 있도록 LocalResolver라는 인터페이스를 제공한다.
- 스프링 부트는 기본 값으로 Accept-Language를 사용하는 AcceptHeaderLocaleResolver를 사용한다.
- LocaleResolver의 구현체를 변경하면 쿠키나 세션 기반의 Locale 선택 기능을 사용할 수 있다.
- LocaleResolver를 검색하면 수 많은 예제가 나오니 참고하자.


### th:text=#{properties.속성이름}
- messages.properties 파일에 정의되어 있는 속성이름으로 값을 가져온다.





















