
 # @Aspect AOP
 
-------------------------------------------------------------------------------------------------------------------------------

> ## @Aspect 프록시 - 적용

### 프록시 적용
- 어드바이저를 만들어서 스프링 빈으로 등록하면 된다
- 스프링은 @Aspect 어노테이션으로 매우 편리하게 포인트컷과 어드바이스로 구성되어 있는 어드바이저 생성 기능을 지원한다


### 참고
- @Aspec는 AspectJ 프로젝트에서 제공하는 어노테이션이다
- 스프링은 이것을 차용해서 프록시를 통한 AOP를 가능하게 한다

-------------------------------------------------------------------------------------------------------------------------------

> ## @Aspect 프록시 - 설명

### AnnotationAwareAspectJAutoProxyCreator 역할
1. Advisor를 자등올 찾아와서 필요한 곳에 프록시를 생성하고 적용해준다
2. @Aspect를 찾아서 이것을 Advisor로 만들어준다


### @Aspect를 어드바이저로 변환해서 저장하는 과정
1. 실행 : 스프링 어플레키엿 로딩 시점에 자동 프록시 생성기를 호출
2. 모든 @Aspect 빈 조회 : @Aspect 어노테이션이 붙은 스프링 빈을 모두 조회
3. 어드바이저 생성 : @Aspect 어노테이션 정보를 기반으로 어드바이저를 생성
4. @Aspect 기반 어드바이저 저장 : 생성한 어드바이저를 @Aspect 어드바이저 빌더 내부에 저장한다


### @Aspect 어드바이저 빌더
- BeanFactoryAspectJAdvisorBuilder 클래스이다
- @Aspect의 정보를 기반으로 포인트컷, 어드바이스, 어드바이저를 생성하고 보관하는 것을 담당한다
- @Aspect 정보를 기반으로 어드바이저를 만들고, @Aspect 어드바이저 빌더 내부 저장소에 캐시한다
- 캐시에 어드바이저가 이미 만들어져 있는 경우 캐시에 저장된 어드바이저를 반환한다


### 자동 프록시 생성기의 작동 과정
1. 생성 : 스프링 빈 대상이 되는 객체를 생성 (@Bean, 컴포넌트 스캔)
2. 전달 : 생성된 객체를 빈 저장소에 등록하기 직전에 빈 후처리기에 전달
3. Advisor 빈 조회 : 스프링 컨테이너에서 Advisor 빈을 모두 조회
4. @Aspect Advisor 조회 : @Aspect 어드바이저 빌더 내부에 저장된 Advisor를 모두 조회
5. 프록시 적용 대상 체크 : Advisor에 포함되어 있는 포인트 컷을 사용해서 해당 객체가 프록시를 적용할 대상인지 아닌지 판단
6. 프록시 생성 : 프록시 적용 대상이면 프록시를 생성하고 프록시를 반환
7. 빈 등록 : 반환된 객체는 스프링 빈으로 등록











