
# JPA 소개

---------------------------------------------------------------------------------------------------------------------------------

> ## 강좌 소개

### JPA 기본편 학습 방법
- JPA는 표준 스펙만 500 페이지로 방대함
- 혼자서 공부하기는 쉽지 않음
- 강의는 이론 + 라이브 코딩
- 6단계의 실전 예제
- 강의를 메인으로 하고, 책은 참고서로 추천
- 총 16시간 : 하루 1시간 반, 2주 완성

---------------------------------------------------------------------------------------------------------------------------------

> ## SQL 중심적인 개발의 문제점

### 개발
- 패러다임의 불일치
  - 어플리케이션 : 객체 지향
  - DB : 관계형 DB


### 객체와 RDB의 차이
1. 상속
2. 연관관계
3. 데이터 타입
4. 데이터 식별 방법


### 상속
- RDB에는 상속이 없다
- 비슷한 슈퍼타입, 서브타입 관계가 있다


### 연관관계
- 객체는 참조를 이용 : member.getTeam()
- 테이블은 외래 키를 사용 : JOIN ON M.TEAM_ID = T.TEAM_ID
- 엔티티 신뢰 문제가 발생한다 (값이 있는지 없는지 확신할 수 없다) - 모든 객체를 미리 로딩할 수는 없다


### 연관관계 정리
- 계층형 아키텍처 진정한 의미의 계층 분할이 어렵다


### 정리
- 객체답게 모델링 할수록 매핑 작업만 늘어난다
- 객체를 자바 컬렉션에 저장 하듯이 DB에 저장할 수는 없을까?

---------------------------------------------------------------------------------------------------------------------------------

> ## JPA 소개

### JPA Java Persistence API
- 자바 진영의 ORM 표준


### ORM Object-relational mapping (객체 관계 매핑)
- 객체는 객체대로 설계, 관계형 데이터베이스는 관계형 데이터베이스대로 설계
- ORM 프레임워크가 중간에서 매핑
- 대중적인 언어에는 대부분 ORM 기술이 존재


### JPA 소개
- EJB - 엔티티 빈(자바 표준)
  - 실용성이 떨어져서 모든 개발자가 사용하지 않음
- 하이버네이트 (오픈 소스)
  - EJB를 사용하다가 너무 불편해서 만든 오픈 소스 (개빈 킹)
- JPA (자바 표준)
  - 하이버네이트를 정제해서 만든 자바 표준이다


### JPA 표준 명세
- JPA는 인터페이스의 모음
- JPA 2.1 표준 명세를 구현한 3가지 구현체
- 하이버네이트, EclipseLink, DataNucleus (대부분 하이버네이트를 사용)


### JPA 버전
- 2006년 : JPA 1.0 
- 2009년 : JPA 2.0
- 2013년 : JPA 2.1


### JPA를 왜 사용해야 하는가?
- SQL 중심적인 개발에서 객체 중심으로 개발
- 생산성
- 유지보수
- 패러다임의 불일치 해결
- 성능
- 데이터 접근 추상화와 벤더 독립성
- 표준


### JAP와 패러다임의 불일치 해결
- 상속
- 연관관계
- 객체 그래프 탐색
- 비교하기


### JPA의 성능 최적화 기능
1. 1차 캐시와 동일성 보장
2. 트랜잭션을 지원하는 쓰기 지연 (transactional write-behind)
3. 지연 로딩 (Lazy Loading)


### 1차 캐시와 동일성 보장
1. 같은 트랜잭션 안에서는 같은 엔티티를 반환 - 약간의 조회 성능 향상
2. DB Isolation Level이 Read Commit이어도 어플리케이션에서 Repeatable Read 보장


### 트랜잭션을 지원하는 쓰기 지연 - INSERT (버퍼 라이팅과 비슷)
1. 트랜잭션을 커밋할 때까지 INSERT SQL을 모음
2. JDBC BATCH SQL 기능을 사용해서 한번에 SQL 전송


### 트랜잭션을 지원하는 쓰기 지연 - UPDATE 
1. UPDATE, DELETE로 인한 로우(ROW) 락 시간 최소화
2. 트랜잭션 커밋 시 UPDATE, DELETE SQL 실행하고, 바로 커밋


### 지연 로딩과 즉시 로딩
- 지연 로딩 : 객체가 실제 사용될 때 로딩
- 즉시 로딩 : JOIN SQL로 한번에 연관된 객체까지 미리 조회


### 정리
- ORM은 객체와 RDB 두 기둥위에 있는 기술이다 (객체지향, RDB 모두 잘 알아야 한다)

















